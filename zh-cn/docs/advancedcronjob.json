{
  "filename": "advancedcronjob.md",
  "__html": "<h1 id=\"advancedcronjob\">AdvancedCronJob <a class=\"header-anchor\" href=\"#advancedcronjob\">#</a></h1>\n<p>AdvancedCronJob 是对于原生 CronJob 的扩展版本。\n后者根据用户设置的 schedule 规则，周期性创建 Job 执行任务，而 AdvancedCronJob 的 template 支持多种不同的 job 资源：</p>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">apiVersion:</span> <span class=\"hljs-string\">apps.kruise.io/v1alpha1</span>\n<span class=\"hljs-attr\">kind:</span> <span class=\"hljs-string\">AdvancedCronJob</span>\n<span class=\"hljs-attr\">spec:</span>\n  <span class=\"hljs-attr\">template:</span>\n\n    <span class=\"hljs-comment\"># Option 1: use jobTemplate, which is equivalent to original CronJob</span>\n    <span class=\"hljs-attr\">jobTemplate:</span>\n      <span class=\"hljs-comment\"># ...</span>\n\n    <span class=\"hljs-comment\"># Option 2: use broadcastJobTemplate, which will create a BroadcastJob object when cron schedule triggers</span>\n    <span class=\"hljs-attr\">broadcastJobTemplate:</span>\n      <span class=\"hljs-comment\"># ...</span>\n\n    <span class=\"hljs-comment\"># Options 3(future): ...</span>\n</code></pre>\n<ul>\n<li>jobTemplate：与原生 CronJob 一样创建 Job 执行任务</li>\n<li>broadcastJobTemplate：周期性创建 <a href=\"./broadcastjob.html\">BroadcastJob</a> 执行任务</li>\n</ul>\n<p><img src=\"/img/docs/advancedcronjob.png\" alt=\"AdvancedCronjob\"></p>\n<h2 id=\"%E7%94%A8%E4%BE%8B\">用例 <a class=\"header-anchor\" href=\"#%E7%94%A8%E4%BE%8B\">#</a></h2>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">apiVersion:</span> <span class=\"hljs-string\">apps.kruise.io/v1alpha1</span>\n<span class=\"hljs-attr\">kind:</span> <span class=\"hljs-string\">AdvancedCronJob</span>\n<span class=\"hljs-attr\">metadata:</span>\n  <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">acj-test</span>\n<span class=\"hljs-attr\">spec:</span>\n  <span class=\"hljs-attr\">schedule:</span> <span class=\"hljs-string\">\"*/1 * * * *\"</span>\n  <span class=\"hljs-attr\">template:</span>\n    <span class=\"hljs-attr\">broadcastJobTemplate:</span>\n      <span class=\"hljs-attr\">spec:</span>\n        <span class=\"hljs-attr\">template:</span>\n          <span class=\"hljs-attr\">spec:</span>\n            <span class=\"hljs-attr\">containers:</span>\n              <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">pi</span>\n                <span class=\"hljs-attr\">image:</span> <span class=\"hljs-string\">perl</span>\n                <span class=\"hljs-attr\">command:</span> <span class=\"hljs-string\">[\"perl\",</span>  <span class=\"hljs-string\">\"-Mbignum=bpi\"</span><span class=\"hljs-string\">,</span> <span class=\"hljs-string\">\"-wle\"</span><span class=\"hljs-string\">,</span> <span class=\"hljs-string\">\"print bpi(2000)\"</span><span class=\"hljs-string\">]</span>\n            <span class=\"hljs-attr\">restartPolicy:</span> <span class=\"hljs-string\">Never</span>\n        <span class=\"hljs-attr\">completionPolicy:</span>\n          <span class=\"hljs-attr\">type:</span> <span class=\"hljs-string\">Always</span>\n          <span class=\"hljs-attr\">ttlSecondsAfterFinished:</span> <span class=\"hljs-number\">30</span>\n</code></pre>\n<p>上述 YAML 定义了一个 AdvancedCronJob，每分钟创建一个 BroadcastJob 对象，这个 BroadcastJob 会在所有节点上运行一个 job 任务。</p>\n",
  "link": "/zh-cn/docs/advancedcronjob.html",
  "meta": {
    "title": "AdvancedCronJob"
  }
}